# 7つの言語 7つの世界 第5章
[全体目次へ戻る](index.md)
## 目次

## 第5章 Scala
Scalaは、オブジェクト指向言語と関数型言語という2つのプログラミングパラダイムの橋渡しを実現している言語。

Scalaを人物に喩えると『シザーハンズ』に登場する｢エドワード｣である。エドワードは人間と機械のあいのこであり、はさみの手によって驚くような能力を発揮するが、不器用なところもある。

### 5.1 Scalaについて
- Scalaは、Javaとの親和性が高いという特徴を持つため、Javaプログラマはその長年の投資を無駄にせずに済む。
  + JVM上で動き、Javaのライブラリをそのまま利用可能。
  + Javaと同様、静的型付け言語であり、シンタックスもJavaに近い。
- Javaとの親和性が高いといっても、盲目的にJavaに従っているわけではない。Scalaに搭載された新しい機能には以下のようなものがある。
  + 型推論
  + 関数型の概念。無名関数、高階関数、関数型らしい高度なコレクションライブラリなど
  + 変更不能な変数

#### 関数型プログラミングと並行性
可変状態を許すプログラムを、状態が有効であることを保証しつつ、並行して動作させるのは非常に困難。関数型プログラミングでは、可変状態を排除することで並行性に伴う問題を解決できる。

### 5.2 1日目: 丘の上の城
Javaなどの言語では、静的型付け･並行性の実装が時代遅れになっており、モデルチェンジが必要になってきている。ここではScalaのオブジェクト指向の観点からみた特徴をまとめる。

#### Scalaの型
- Scalaでは、Javaと異なり整数などもすべてオブジェクトである。文字列も同様。

```scala
1 + 1
// res: Int = 2
(1).+(1)
// res: Int = 2
```

- ｢文字列に数値を加算する｣ように型の不一致を発生させても、Scalaはできるだけ型を強制的に変換し、正しい式となるようにする。
  + 型を変換できない場合は、通常の強い型付け言語のようにエラーが発生する。

```scala
"abc" + 4
// res: String = abc4

4 + "abc"
// res: String = 4abc

4 + "1.0"
// res: String = 41.0
```

#### 式と条件
- 条件式やif文はC形式のシンタックスである。変数を宣言する際には`val`または`var`で始める。前者は変更不能、後者は変更可能な変数となる。また、宣言と同時に値を代入する場合は型推論が働くので明示的に型を記述する必要はない。

```scala
val a = 1
val b = 2

if (b < a) {
  println("true")
} else {
  println("false")
}
// false
```

- Scalaでは数値や`Nil`の真偽を判定することはできない。真偽値は常に`Boolean`型の値で表す。
  + Scalaでは、`Nil`は空リストを表す。

#### ループ
- Java形式のwhileループが利用できる。
  + 関数を定義するには`def`キーワードを用いる。
  + Scalaでは、`public`が変数のデフォルトの可視性になっている。

```scala
def whileLoop {
  var i = 1
  while (i <= 3) {
    println(i)
    i += 1
  }
}
```

- forループもJavaの拡張for文と同様の構文が利用できる。
  + `<-`の左にある変数が更新される。数の範囲は `[開始値] until [終了値]` で指定する。

```scala
println("for loop using Java-style iteration")
for(i <- 0 until args.length) {
  println(args(i))
}
```

- Rubyと同様にコレクションを`foreach`メソッドでループすることもできる。

```scala
println("for loop using Ruby-style iteration")
args.foreach { arg =>
  println(arg)
}
```

#### 範囲とタプル
- ScalaはRuby同様ファーストクラスの｢範囲｣をサポートしている。
  + `until`は境界を含めない。代わりに`to`を使うと境界を含めた範囲となる。
  + 増分を指定できる。負の値を指定すると減少する数の範囲を得ることもできる。
  + 整数だけでなく文字の範囲も作ることもできる。

```scala
val range = 0 until 10
// range: Range = Range(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)

(0 to 10) by 5
// res: Range = Range(0, 5, 10)

(0 until 10) by 5
// res: Range = Range(0, 5)

(10 until 0) by -1
// res: Range = Range(10, 9, 8, 7, 6, 5, 4, 3, 2, 1)

(10 until 0)
// res: Range = Range()

'a' to 'e'
// res: NumericRange = NumericRange(a, b, c, d, e)
```

- タプルは、固定長のコレクションである。各要素の型は異なっていても構わない(要素数と各要素の型によって静的型チェックを行う)。Scalaでは要素を丸括弧で囲んで表す。
  + タプルからn番目の要素を取り出すには、`._n`というメソッドを使う。

```scala
val person = ("Elvis", "Presley")
// person: (String, String) = (...)

person._1
// res: String = Elvis
```

- タプルを使った多値代入が可能。

```scala
val (x, y) = (2, 3)
// x: Int = 2
// y: Int = 3

val (x, y) = (1, 2, 3)
// error: ...
```

***

[前へ](c4.md) /
[全体目次へ戻る](index.md) /
[次へ](c6.md)
