# 関数プログラミング入門 Haskellで学ぶ原理と技法 第9章
[全体目次へ戻る](../index.md)

## 9章 無限リスト
### 極限としての無限リスト
#### 近似順序
- 無理数が「有理数の無限近似列の極限」として定義できるのと同様に、無限リストは「擬リストの無限列の極限」とみなせる
  + `[1..]`は`_|_`, `1 : _|_`, `1 : 2 : _|_`, `1 : 2 : 3 : _|_`, ...という無限列の極限

- 近似順序`<-`: 「`x <- y`」は「xはyの近似である」という意味
  + 反射的・推移的・反対称的であるが、任意の要素を比較できるとは限らない => `<-`は半順序である

- 数・論理値・文字などの列挙型に対する近似順序: `x <- y ≡ (x == _|_) || (x == y)`
  + `_|_`は全ての値の近似である
- 対の型`(a, b)`における近似順序: `(x, y) <- (x', y') ≡ (x <- x') && (y <- y')`
- リスト型`[a]`における近似順序
```txt
_|_ <- xs
[] <- xs ≡ xs == []
(x : xs) <- (y : ys) ≡ (x <- y) && (xs <- ys)
```

- `a`型の値の各近似の連鎖`x0 <- x1 <- ...`は`a`型の極限値を持たなければならない。極限は以下のように定義される
  1. 任意の`n`について、`xn <- lim_{n→∞} xn`
  2. 任意の`n`について、`xn <- y`ならば`lim_{n→∞} (xn <- y)`
- すなわち、近似列の極限は近似列の最小上界(上限)である

#### 計算可能関数
- 全ての関数が計算可能というわけではない。計算可能な関数`f`は近似順序に関して **単調** である
  + `x <- y => f x <- f y`
  + 「引数が詳細になれば、返り値も詳細になる」
- 計算可能な関数は **連続** である
  + `f (lim_{n→∞} xn) = lim_{n→∞} f xn`
  + 「極限値にfを適用した結果と、f xnの極限値は等しい(極限に至る途中には驚くようなものは出てこない)」

#### 連鎖完備性
- ある性質`P`が任意の近似で成り立つならば、その近似列の極限に対しても`P`が成り立つ、という`P`の性質
  + 連続性と異なる点: 逆は成り立たない(任意の近似で成り立たないけど極限では成り立つ、ということがありうる)
- ほとんどの表明は連鎖完備である。特に`e1`, `e2`が`xs`を含む式であるとき、`e1 <- e2`という形式の表明は連鎖完備である


### 循環構造
- データ構造は再帰的に定義できる。このような式のグラフ表現は循環構造を含む

```haskell
-- 無限に1が並んだリスト
ones :: [Int]
ones = 1 : ones

-- onesのグラフとしての表現は循環構造を含む
-- ┌--┐
-- v   |
-- 1 : ･
```

- 無限反復`repeat`: `repeat x`が`[x, x, x, ...]`となるような関数

```haskell
-- 正しい定義だが、循環構造にはならない
repeat :: a -> [a]
repeat x = x : repeat x

-- 循環構造となる定義
repeat x = xs where xs = x : xs
```

- 反復適用`iterate`

```haskell
iterate f x = xs where xs = x : map f xs

-- whereを使わない定義だとかなり計算量が増えてしまう
```

### 例: じゃんけん

***

[前へ](c8.md) /
[全体目次へ戻る](../index.md) /
[次へ](c10.md)
