# リーダブルコード 第2章
[全体目次へ戻る](index.md)

## 2章 名前に情報を詰め込む
情報を詰め込んだ名前の付け方に関する6つのテーマ

### 2.1 明確な単語を選ぶ
- 名前に情報を詰め込むには、｢空虚な｣単語(例:`get`)を避けるべき
  + 例えば`getPage`というメソッドはどこからページを取ってくるか明確でない
  + 木クラスに`size`というメソッドがあっても、木の何の大きさを返すのか伝わってこない(高さ`height`? ノード数`numNodes`? メモリ消費量`memoryBytes`?)
  + スレッドクラスの`stop`メソッドは、取り消し不能な操作なら`kill`、後で`resume`できるなら`pause`とすると、よりわかりやすい
- 類語辞典でより｢カラフル｣な単語を調べて使う
  + やり過ぎは禁物

|単語 |代替案|
|:----|:-----|
|send |deliver, dispatch, announce, distribute, route|
|find |search, extract, locate, recover|
|start|launch, create, begin, open|
|make |create, set up, build, compose, add, new|

### 2.2 tmp や retval などの汎用的な名前を避ける
- `tmp`,`retval`,`foo`のような｢空虚な名前｣ではなく、 **実体に即した名前** を選ぶ
  + 以下のコードの変数`retval`の場合は、`sum_squares`のような名前が良いだろう(`v`の各要素の2乗の合計なので)

```js
var euclidean_norm = function(v) {
  // retvalという名前には｢これは戻り値です｣以外の情報はない!
  var retval = 0.0;
  for(var i = 0; i < v.length; i++)
    retval += v[i] * v[i];
  return Math.sqrt(retval);
};
```

汎用的な名前を使うことに意味がある場合もある。
#### tmp
```c
if(right < left) {
  tmp = right;
  right = left;
  left = tmp;
}
```

この場合、変数`tmp`の目的は一時的な情報の保管であり、`tmp`という名前で｢他の役割はない｣(例えば他の関数に渡されることがない、など)という明確な意味を伝えている。

- 一時ファイルなど、実体のあるものの場合`tmp`の後にその実体を表す名前を続けると意味が伝わりやすい(例:`tmp_file`)

#### ループイテレータ
`i`,`j`,`k`,`iter`などはループイテレータとしてよく用いられるので、これだけで｢これはイテレータだ｣という意味を伝えることができる。
- むしろイテレータ以外にこれらの名前を使うべきではない
- イテレータが複数ある場合は、もっと明確な名前(`i`の前に実体を表すプレフィックスをつけるなど)を使うことでバグの発見がしやすくなる

#### まとめ
汎用的な名前を使うときは、**それ相応の理由を用意する。**

### 2.3 抽象的な名前よりも具体的な名前を使う
メソッドや変数には、それが果たす動作･意味をそのまま表すような名前をつけるようにする。

例: `DISALLOW_EVIL_CONSTRUCTORS`...C++における｢悪の｣コンストラクタを許可しない規約に基づくマクロ。しかし｢EVIL｣という語では｢何を許していないのか｣が表せていない。最終的には`DISALLOW_COPY_AND_ASSIGN`というもっと具体的な名前に変更された

### 2.4 名前に情報を追加する
変数名に詰め込める情報は変数を見るたびに目に入るので、大切な情報は｢単語｣として変数名に追加すればよい。例えば16進数を表す文字列はただの`id`ではなく`hex_id`にするなど。

#### 値の単位
変数の中身が計測できるもの(時間･バイト数など)なら変数名に単位を入れると明確さが増す。

```js
// getTime()は秒ではなくミリ秒を返すので正しくない!
var start = (new Date()).getTime();
// ...
var elapsed = (new Date()).getTime() - start;
document.writeln("読み込み時間: " + elapsed + "秒");

// 変数名にミリ秒を表す"ms"をつけると明確
var start_ms = (new Date()).getTime();
// ...
var elapsed_ms = (new Date()).getTime() - start_ms;
document.writeln("読み込み時間: " + elapsed_ms / 1000 + "秒");
```

#### その他の重要な属性を追加する
注意しないとセキュリティバグが起こりうるような場合は、危険や注意を喚起する情報を追加するべき。例えば｢安全ではないデータ｣には`untrastedUrl` `unsafeMessageBody`のような名前をつけ、安全にする処理を行った後は`trasted ~` `safe ~`にする。

その他の例

|状況|変数名|改善後の変数名|
|:---|:-----|:-------------|
|`password`はプレーンテキストで、暗号化すべきである|`password`|`plaintext_password`|
|入力された`comment`は表示前にエスケープするべきである|`comment`|`unescaped_comment`|
|`html`の文字コードをUTF-8に変えた|`html`|`html_utf8`|
|入力された`data`をURLエンコードした|`data`|`data_urlenc`|

### 2.5 名前の長さを決める
長過ぎる名前は覚えにくいし、画面を占領するので避けるべきだが、｢長い｣とされる基準は変数の使い方によって違ってくる。

- スコープが小さければ短い名前でよい。名前に情報がなくても、近くにその変数を理解するための情報が全てあるため。
- 長い名前でも、補完機能によって簡単に入力できるようになっているので、積極的に名前に情報を詰め込んでよい。
- 頭文字や省略形は、｢新しいチームメイトがその意味を理解できるか?｣を判断基準として利用する。プロジェクト固有の省略形は理解されないので使うべきではないが、慣習的な省略形(`eval`,`doc`,`str`など)は問題ない。
- 削除しても情報が損なわれないような単語は捨てる。(`convertToString` → `toString`など)

### 2.6 名前のフォーマットで情報を伝える
プロジェクトで一貫性のある命名規約を使うと、コードが理解しやすくなる。

規約の例:
- 定数の名前の先頭に`k`を付加する
- コンストラクタの名前は大文字で、通常の関数の名前は小文字で始める
- jQueryオブジェクトの変数の名前に`$`をつける
- HTMLのidの区切りにはアンダースコア、classの区切りにはハイフンを使う

***

[前へ](c1.md) /
[全体目次へ戻る](index.md) /
[次へ](c3.md)
